Задание 2. Шардирование

Для запуска, из mongo-sharding выполняем последовательно:
 docker compose up -d
 ./scripts/confsrv-init.sh 
    ./scripts/shard-init.sh 
        ./scripts/router-init.sh 

Для проверки данных:
./scripts/router-data.sh (1000)
./scripts/confshard-data.sh (492 и 508)
    
Задание 3. Репликация

в compose.yaml добавлены реплики для каждого шарда: shard01a, shard01b, shard01c и shard02a, shard02b, shard02c
+ дополнены скрипты инициализации shard-init, router-init и скрипт проверки данных shard-data

Для запуска, из mongo-sharding-repl выполняем последовательно:
 docker compose up -d
 ./scripts/confsrv-init.sh 
    ./scripts/shard-init.sh 
        ./scripts/router-init.sh 

Для проверки данных:
./scripts/router-data.sh (1000)
./scripts/confshard-data.sh (492, 492, 492 и 508, 508, 508)
    
Задание 4. Кэширование

в compose.yaml добавлены инстансы redis, обновлены настройки контейнера pymongo_api

Для запуска, из sharding-repl-cash выполняем последовательно:
 docker compose up -d
 ./scripts/init-CS.sh (инициализация конфига и шардов)
    ./scripts/init-R.sh (инициализация роутера)

Затем выполняем curl http://localhost:8080/somedb/users и можно открывать pymongo_api на localhost

Для проверки данных:
./scripts/router-data.sh (1000)
./scripts/shard-data.sh (492, 492, 492 и 508, 508, 508)


Ссылка на схему:

https://viewer.diagrams.net/?tags=%7B%7D&lightbox=1&highlight=0000ff&edit=_blank&layers=1&nav=1&title=sprint2_schemas.drawio#R%3Cmxfile%3E%3Cdiagram%20name%3D%22Page-1%22%20id%3D%22-H_mtQnk-PTXWXPvYvuk%22%3E7T3bbtu6sl9jYPUhgUjdHx07aQus7lO03XutdV4KJVYSnTp2ju20ab9%2BUxJJUxzakm2JpCsBhSszlEzNDOfGuYzcydPr21Xy%2FPhhOUvnI%2BzMXkfudIQx8lyP%2FJeP%2FKQjfhyXIw%2BrbEbHtgOfs18pHXTo6Es2S9eViZvlcr7JnquDd8vFIr3bVMaS1Wr5ozrtfjmv%2Fupz8pCCgc93yRyO%2FpXNNo90FAXx9g%2Fv0uzhkf50hMPyD08Jm0zfZP2YzJY%2FhCH3euROVsvlprx6ep2k8xx6DC7lfTc7%2FsoXtkoXmyY3fPzfd9%2F%2F%2FHKN3k3Tt78mz9FfqRdfIJ8ubvOTvXE6IwCgX5erzePyYblI5tfb0avV8mUxS%2FPHOuTbds6fy%2BUzGURk8P%2FSzeYnxWbyslmSocfN05z%2Blax49fPv%2FP5L7LPv%2F4h%2FnL7Sp5ffftJv9%2FPlj%2FEiI7DNlgs6NkvWj8Vi8pvvXlbf%2BcoghCjQ1suX1R193V9j7H5Yfvn3%2BsuN9zVGm%2Bh79u8LTCktWT2kmz3gC8p5OciEH6Dwf5sun1KyejJhlc7Jkr9XaSqhpPnA522xRy4oAtXI3Lfq78n8hf4SobnVzEEAx2T8Ob%2B8%2BznPCCpXLoHWj8dsk35%2BTgrA%2FCDbuYqz2xLpf97ygeTu20NBCv%2FzsiGPSen4usQ68vdh4Hu62qSve2FG%2F%2Bqy%2FcM4SERZyg9hO3p0zqOwE7HrnA5nJdYj1%2FCmqewZp2bPHL8L3Ia7wLdqF7hgFzz%2FfFouHpYXyXMGELdFC6rfAy2QsxdVyZlRrkjNWEHNQVfEjAC40MWIEE4up53iAhefxfW4HIm2I%2FG0GMd08hgVn37xp%2FJzUowQ2Dl%2FjPAVm1c84opco1FUjFx5xWckjFwXn5jNJJ9TNod8%2Bm8AMgkONjkH2qyW39LJcr5ckfHFMmdNV%2FfZfC4NJfPsIZci8%2FQ%2Bvy1HYkYk%2F5gOP2WzWbF114QgssXDn8W0qbcd%2BUTxkw8tye25eCJfH8mNKXnC1fMyW2wKhPlX5B9B4STfvD5Z64R8R9vv5F8%2BfbWZLBdk%2BUlWEFiarDc%2F0vWmYB%2BbZJPcFm%2Fq1FPq%2FXKxYfxIoSkcTLYYkqkbKsg07IpMoWzDOsi0JLtixtVN8XklkOBYIOJAIN%2BbEQ7mm5JOFhUSDf7%2FJdf3BOF5cVcS5TiHwCLbZMm84DRsJrl6yP9%2Fw55JwFc%2BthwfNoH2TcBYd2h6U0BR52rYFPG4IPJp8RkNXPtsCBY5ODBMscgzrDqHB9mbFduykSKtfGuvoSJtzJzct2pgTmKAwjMyJwPXOnMyNLEljifm1q09euvHnO1uERU6MqIk%2BJe7id4loYAv4wQj3wijes02fzNORK4L%2B74098m3LZPKvxxk35vEpBubxaQP%2BBjB0yZdQQTP59nzOtXjB5CBghSOAEenIyAAYGIWR66WKK2Y%2FA8XJYPOzRfkPb8qbZe75eI%2Be3hZlW5b8qR09T2HPzdoyl%2FYYdAc5KKR1cFNvvPaQFjkVRGmUP5xpMAXFybt61IOwFgJ6K8G5bR76XkIhQExjvwocl3ktQP%2BWN4vGF36cMcgra4z6DurIMCI3929JHDHro%2FjAg9O3BICokBmWHFD8PtdgR8SeGsCmF03EcD5l4%2FpKiNvla5EM%2BJv8YvwpD0GR%2FFNfhijGoLsbycJfEawtYYIw6Mllggyc%2BCiooX9lLC1Mx3Hq2Le9dyjcE9wtRnnB9k525gn63V2x4Zvsnlr6vyZ2aYoMEIRFp1bq8ESNsQm9uxCZwgk6af0eU4UOTL4Od2YEKTOTm1S8kC2IFzlQ%2B4gMO6ViEx76to%2F5FaTXtR0y7h2bZkIbBmbz7l9xQmi5oPu2DBBG3E9MxCfm0TA0LjtlUSQ%2FdQWSAQM7VmrHdXtM%2BxmnupAZmEd%2BzcxtIN%2FO1e1LlzKvmrtuIRH%2BhY6q%2F3YtLMaw8PJwVu9x1vt%2B8bd1Riew4jeUgu81TiKu3FWB455ZzWG5zsi%2BC3wVftB2I2rmuecGHNVY3jGP7iq9wt8Sq71doux6HP1cozGDfzermrcNCHBNls2Bqz346f3H8af%2FjHBdItIKrXiUcQflrNakoSuxIq5rSSw4kDBif2uxKAL%2FQrrlAjCWUIf%2FltjQ3Izhwo9Xi824Al6f7DhObZhA2rofeFTQWgbn4Lqen92huz8NL8z4Plkf7ARItuwYfok56CjSaWuzM%2F78ye3dNTjNg3lcO2K5WAepwGdR6IztAudUKc72DWLgGvWuU%2Fuqve8TVbJE2HB0IG7Kg8KS%2FdtM6%2FtkIPW4nEBUKYUsdIqgYG7EhgeBiTZq8NkC8OLPHjQ1RdbwzqfiKfI9OuNdmudT8SDVnh%2FsGGdT8RrIS1q0GbOWZsB7Nq4NnP%2B5q869v3EJPump0OeXadD%2FmD%2BnoZOuw6A%2Fd3m7yz7zll2XkflRqiaUlZHmQjlhsSqKazoEHaEoisnFc8albVcrsbsImJzyBNQ8Sndy8cJYpwPeaD59EoQSOLLKd6XDt2u5BH51lw68vRJh783T2l1LhgUPOFty09XBcTyTcgnq19DgSUCZUon5J8%2BfD2wQBaTt10MYj%2FKl4QFlPBXmVQxV%2BKSX7sC3Et8hKoKUyVIGkM%2BX%2FCumLbtC%2FgAmlPhBXD1BXxAIHtgWiW37bRAuPFawN91HZnn%2BgN74I1w%2BwQ8yqmsVsCbMFPchb7wK3613Bcno0l1x4SqVxsf9VLlV1RFBPzdWlCrKaOJjjjCboRv3SCQFEUyPvPTaObVa4ulZXCGquJDHrFCp1bFK6%2FcuzeGublGiZAUH6goAhmqwmlB5Yz2pBY2rITYmU%2FpN1VCmAFgixICvWu9dngiVQFL3QmVpktta0qo9JtWO%2FNjq%2FYMCozkN1mMoMiuc2IfuqltznhFTgirLepNefVNsxwjKa9%2B09Bx24Q2dDX3SmiD0owWCG3%2F3Iozti5T6a111Rkxq8iiq6hfH%2BozakImKNCoHZkwQcLCrFeEPIVA11ujEWYvDGmve9JeEXIgyjTnvTKzwqoyjf6lI2Rehm0VCQRVGpEfGs98DfB%2BBBhJffUutzUavdAJcUsbAFRp9BU8Swl%2Bryvww%2BJ9Q%2B7rXrnPCLbegEFtKwinYdpMybBe5L4yFencjNqgvzllcuAQwgperDWYLehzUhk4E3AV6rxedPQ5q0yO9DSPjhAaV31hVXLGhnlWFfY5Mxx4Qs3vDWhD9QcdcgKsBeg4qw602mJGGRerVZJDuwyn8KxqLVuITmwXOqHNM%2BSMnE8gYBf6lKvovKg1aQSxX9PLY3YnenTuMQlbj15Rn55h%2BcwBOxISOz49C3seN2BjsF8ITfu%2B2JL2ub1C2CqhP8aLfW6vEJ729wcd9rm9Iuj2GrTVXmmrgGMb11ajswrF1pbiHDZt78UkniUGcYTPHp2d%2BDcao9OuTIlIZXDMsvVO4f2YviYPy4JPCmCloxzSuJ7Z3Wev6YwivCXmh%2BSwfWWUnyps3%2B8qYiYyEttaIeqKdX47X959%2B%2FKYLRT2eWVf8PBYHorzj%2FCXA8NjO7fb3fgy9qq4B6Z7uYeB6Q4eBk5sPFk27nACEBgnP4VpVJFo7m3w6eFE45VJN5CLcg2t%2BiQCaHJ9fjf%2BNP0KBfugyrWpyvmADiE3U8W%2FduYJCaC1V1IC1AkGSmjTBS0r9cYpwcVqSlAE4A6U0CFPiBQFrPQSAsxOLwlhYAlaWYJxQohhkI93UZRGIkKjKHASFzVm4uJ6XI5E25G4KH8yxnTyuCjCMy4Kt8TlZ1ESZpz7o%2F4oC%2BFsR6944R5ehUcsaIOOragEqzpdCbcHOyo8xW8G2t9t9uVuWAoY1MJGkF3iTCUWN4IbKnZC2NlOMO0hsbP%2BSty0%2FgpissMSF0nc9wIs8jFHzGKczJ3JohMrLaLjNlllK7TkOYxbr3modh6EsnMskI%2BhOo5tQMYLUx3kOq6NcNnhRTudEhpwSLtiHhFLRjGEWVTBqyD%2FdqDWMmy23xD7NHkHQx6F2jxfFSa%2B7vI8ruwHDV2o9OktzxOb3QGGyvPETU%2B9rNPpYExXr3S6QE6DsECni40clR1P%2FB1I4R3HPrLmFsu2a8eaG%2Bu5%2FTsX6NGGTVeOJ9eNTf6mIvNjxZS%2FZKdU6rkn896NmF8he%2F7PqOMiMZ58hMqLZoh8TBXvhOTj4fa0YSbrhso%2BOwqbyD47FdI0V%2FZBDvTy%2FL6lfQALQsh4aR%2FkwJqgv29tH5lvxQq3td7aPsiBFUaH4j41OkPT8rucvVhi%2F%2FBaakN9n%2Faz1biCdXZmMXJ6nOsksWSihEGWrDWbAzm9TnaSjp22Grs5fPQ528mNrMMH26A95FaBbx23Qr0u84Ps2x3QDdEjfMT24WMo9LOXi9dry4zD2KIto6HWz6kYtcz%2BQUO5n3MOLu1EsYqaCY4Oy%2F2Ybv1zUGjBbo7SveMFNW0XZFvMDV95XwMSrAwyRYM3zCb7cvCG2WXPDN4wq%2FDBFJBBd%2B2r7gqZtnHdletuVuiu1lT%2F4apFAxPZrvo%2FCOOzx2g3To%2FmGLWrBBC3hQTBMSFAGe2IBuy8EtDjcpX9IkIj6TwSDbGuujwSTSHFlW0BOwwfxNAUHOqtGMgq2ZaTMpVTjzA0QIeCKzqcgLIiZZ4UPMMJRhWhWxt3V1OArF2vH46aSl6GHlskr2cmsaKNjNhW68O1iWNsm3YF3Vbjj%2B8%2Fv%2F%2BbjL1NNumPBHpLGidctMDrPLm4lB839Lx2Fwrundaq%2Fcjs%2FpNPPADnOzze9ZQtEptjg%2FRW%2B0oOnJX74WQGqyWx%2FQBCs65OwWl85XRyiP1QUqRQXQz7sXUolJ4PPezF64S9HFpeFaTNsqSbXeVVMRM7x99Aqzt3Wo%2BVY2JXgQZoHOou0BDIGX7mCzRwoSd6uYjB%2BTI3Dq1QhlbgKDQwFbS6S4d0YTDvqsgRVtX%2F0KquylVxY4XLTlXvrbszDkUxVAYrha9cI6x8R3JvxopuSpphBX3Nq7zevIqszqLkfCwLGQWnU%2BafR52BGObRUhBDajxPECtqnTJHviYQwzDRMYDt4JFt0zkveSmU8UgqEdkhEcBzmiG%2BoVsikBQlZdCNigg6lGfwhGYyEEGnCiCMhMOmOQE0yAZxoLUprwXiwIP25SAOuiUCcGDfkBN0Jw48aDYP4qBb5wlMvIXOE82cwEghQ8HL7AWR6GW%2ByGun4Bo3c32gnK0nvu0X0D6xNDl0cQjuWUAa2ovnSvrTBVbFvOn1zfrQZfEhB9gUSlBdiQQtQNr3wktfgjVSlFlTna3H3cHacDbhyD0kkKjtUyy%2FcRcKv%2FVTrBPxBt0NLMmCyPlFBaMsMaPYGBfrcmfkCR7Pq3SkKis5yoNO3TI3hidulI%2BlE6asXU%2BlM0%2FRCCf2tg18aHufm9H%2BNj6MvAetSEOLHB8wfMiE9LbIQT50mzDCm2XfK0QHezBNdvRduqLX2BFu8VkjJ2FC%2FtfgiJ5QTwSl6epiPU%2FIbqctosbbi%2B2N5cM94bGT4odctrapcEsorHNSXS2ZyV%2Bf3v4H63HFu1457MfyGW%2FocmJEd2a%2B7fmOFmGrADcdul3JI%2FKteV7YNj15nacnO2RP0DqdF0m%2BRcg4%2FXp7KXy5K7eL8uf3PhZXH4vFx2L5sfKCm%2FAawgAjfOsGgcRwyPjMT6OZV891ysSEM2Q5D3koCZ1alfUEwLNilXsF7wGnOfJxjq88k1QabN2xIxijuRVsdAcjYX%2FjHVyn3NPl%2Fua79BAes92tR%2B3LnXuq6OjtXLBFHtfXzmfcCwlcyhcexd5L8Svii%2FsCSxMfgtUwxCKgHPmrzNdDVR8%2FDwC8fHjJYvm0qGQwwpKQCsVR9a5p9RX4EzjZcCCUrxwLi2F3TXn3wpuRJFg4J6fAD6sw5JgKq3LvmkqMKe%2BFyG5pXxwM3NVa7oqcELYK1s5e4flIQdOuQKkiMwqF%2FTMF3TzLTTsR9t61sOX45LYag0qb%2F1jW2Q1nl%2BP%2Btix%2BWn2dktmR61jgYhy8CECGjR%2F%2F1iUvO%2BhtYF7E9n18gZFHwi85Atfk73AtcEqml2NHgIUvrN6rTvAEIhOYcUXOiG8r%2FmjxfCoBJK6PABzFN%2FIrP6oQiaGAmxvA5hFFMJ0sGkjcFOHmR2Pcb0cmbeyB%2BEBqYNGZlAb4kqDGEQnEWiJXBL4ooiGBOu8%2FXggzvSqC%2BI9y5J4IAUeApEQJbuVdtnqBSEWB8LRo71YXNRS%2B5vzz4kAK4G8eJE%2B5XFvcrp8PZ1RCQOSebaZUmRzGp0XuPq6CoHZ7QBSyp%2B14r50%2Bta3z%2BOKu1GFyTS1bZJssT1hXONdkJq12sB2qlrW4QIoiHiS4E9OqBbe5jnMgjO7BcBK9DLq4vbq4KrNSty4eGKlZW5MPviOFyejxc%2BsFInfkEEXxJSMLHqYvn%2F6VywVpkrUpT7n9V33SjoTLQ3OrMMgsiGtSpUDDyQNv4MfPzd%2B9ekNHyViBIr17ONvqNIBBzuvDqvZxWiN%2BgiEA1DARhA0jwbujAXZYOsR%2Fmip3iFwP%2Bjr1xn%2BGMP5zIAKt9dptIAI8EIFZThDGzaRBhzQAg0AHGtDKCCygARjVOmiF3dJAbJ1WCDOFh4SQbhNCXKAQRKaJAIbuDkSglQjCGJumgSFRWHeiMLaOBqCvcKABrTRggzAYfIWGtUILHMbMeykQgV8EZsQsRiQuQ%2BTKLJpyJNqOlMk2Yzzan2Yzzs%2F1%2F6DhNNN%2FvRnoTFvSjVyqxFWYIpqTbiLTxVDxQWV1c9oYL7Knsp%2FQvl4sJx71RlQvqM8JZBqELTmBbOW97RqIsJRhi1X113T3DYxO6%2FR8ZPnq3WWoT9kbQdsUrz69J8q5jEnfCapP6bpYdHRW7ZyPrQvcAjE0YJSWFX6OzCa9owpiBTm4A7eWoRMjy3LhI%2BhQqwRNQkVHe5UND%2FKzCB5Maq6zEZmufx4epAG2JsQaNw%2BxTsGDHqNeKXgBtlPBM9K354Qd0L483hGECdW4CGtW4xS1RXQwORaePBJavfBQ5dbDk3Uh1I0sQCgMqvpUpBONdnSobFxj%2FZ7Mezdi7obs%2BT%2BjjhtOej4AZ4gUaoGyYnh3LSeZ2DuldbQHWkeXKSl3y8V99vCyom2hnXVK7JZV0%2F7QB%2BltnaEtchuhTdkSEHXXpCGGQUYltL%2FSsigm1AP%2F0oki7Po49hAKw7wETRsoiCEjCgNeX03cO0irSh3DIJ8KDqApogEH3iVHQOCFTohb2gYK7hUouJcSA15nGIC2fWvSvNK4rUaa51%2FkSnWtlr1jhEPw%2Fe1E7YEio4FB1Hoa1InINtMG9eA%2BfoLN6zheFfmuV9fzS41%2BhVOoXYcQU7TOz06OYXTNx0%2FvP4w%2F%2FWOC%2FRYFRNXKSHHMWM6KW%2FI0QaYcKZiySqOUuzG2iA%2Fot1inRC7OEvr03xoj8FQq9o1jBIad9Agj0C1hHCO87HIPeVYQ2MezsAPdDP3ZIQpHqwU7BLol%2BoOR0LERI6dFNmg%2BIq%2FvadDSCRPn5fVHqZa1RMbOWQU9WIlRu2whXprjFGcuAs5c5z65q97zNlklT4QZQ5fvqjyiLB2%2Bzfy8QyBqmwHPUL2K3Waio7NsSOyY8dzsYDR1oQe7eUrnbhjshE1Zj2VxOXzlfQ1XsDMeFTvQG9MXS9NG7xh2eu2LsdA7xouN9RMjNnrHEPTGDFpsr7RYBes2r8UibJMWe5S5rM6hOlVnbRpiy4WfLTorGlxaJ2KUCU9rMApDciYEKKMd0YJMnD%2Bmr8nDsmCbAnzpKAc5rud999lrOqOYz78%2FLlfZLyI2ks7j1FAgd5zEgUKSI2XN4c7CC3nTSwEhn9%2BNP02%2FwuCoQYJ2moTiOgoJqopa7M4YRTB3pyQGKFkHYmi1PpqNxGA4Iakiemuj8mqqmLfrBURxU%2FmLLfMCsrIZ56FRGSwyfwiO7YrD5CsXq9iA7k0yETRNy2iB23khMB49v6EntrNgcW6X6i0McPIZCOB9h8fDnrBJcNOW3R0wQnqrfcUKtvDrB5PVkhHfnNRsK3CAsWm%2FVOyHkjKF6qLcj61gofSB6GEwUScM5tDuK4os24AmRuxsp%2BLHLdwSur5Eqh20VOH42FXdAZK67uoOAcwHNF%2FdgYs%2F0e9FeygahlcI4eUpavAp4dVZ%2BiTBGYAXa1OoEK46lVcYvxMq3Hiq6nHdnXxg6LcRmjoahJaPgNMzVDY91gotGAlD%2ByvuTgjtzAHdApAxjEYOFBxPmbfeVRVNLo4hkCFFnimQQwyB7PtagTzUq9Xttoe%2BC1XMktaKtdwHPDQ00UYGUGlSheVo7WmCXRiWM5Qw71YZVMXLGS5ijl08CAXNx3eKQkzmhcLQ5Uo3GcC6kk25QYdCQeF4GMigU4eKIl3XdFMD7JotsutcekEk%2BqAv8toruMYJXR9QZ%2BuZcAe1uU%2FEv5EMr7NrLd9B1pbage86%2BNKrtpbHkSedUzZuLQ%2FOHFwnaHbmeXBzeejQY8veeVahqBN78C0uQvtvUcBAuqWjExFX0Txs%2Bq9RnlNXFlPc6X7luSrz5ctMi2hCnoQI3qq7ztMfdaegQEfhX%2BntmoBiD%2BhqQJWsn9O7fOWFI7AlVzaLweWw8yDsVBF6HYLOSKljQahH1ZrhR9bOq03hbT%2BYwG0cQM%2B2ty2CnBGdOUUuimVFzvOOQbsW9DGNzRr0qVLnaAuwUdkw7MorPq9GBPLRDRt0i8%2Bif9jVNRshE8q%2FOsV1eWNUXIdsPrkuOpBdjelf6QPLh9wUEzC7kXxOhOtQeKB4F2Y%2FSj6nwmf515j9RChM46sln67wV3FV5VL5epzq2va8FAdIcU1%2FXfzTVHiUD0bgllIaxKO84vatSzSrqlVMxmd%2BGs28etO4zCY5Q7v4IefEdGqVmxAtZlascu%2BePkBHQbEsaBXWc6hMkzlC1JKvq2WeW7pVCsnLP35YztJ8xn8B%3C%2Fdiagram%3E%3C%2Fmxfile%3E